# tunnel.config.yaml - AI-Tunnel v2 配置文件
# 复制此文件为 tunnel.config.yaml 并修改

# ═══════════════════════════════════════
# 服务配置
# ═══════════════════════════════════════
server:
  port: 9000                      # 统一入口端口（应用连这里）
  host: "127.0.0.1"

  ui:
    enabled: true
    port: 3000                    # Web UI 端口
    host: "127.0.0.1"

# ═══════════════════════════════════════
# SSH 连接（可选，不用隧道可删除整个 ssh 段）
# ═══════════════════════════════════════
ssh:
  host: "YOUR_VPS_IP"
  port: 22
  username: "root"
  # 认证方式（二选一）
  privateKeyPath: "~/.ssh/id_rsa"
  # password: "your-password"

# ═══════════════════════════════════════
# API 通道配置
# ═══════════════════════════════════════
channels:
  - name: "hotaru"
    target: "https://hotaruapi.com"
    keys:
      - "sk-your-key-1"
      - "sk-your-key-2"
    keyStrategy: "round-robin"    # round-robin | random
    weight: 10                    # 权重，越高越优先
    tunnel:
      enabled: true
      localPort: 8080             # 本地反代端口
      remotePort: 9090            # VPS 映射端口
    healthCheck:
      path: "/v1/models"
      intervalMs: 60000
      timeoutMs: 5000

  # 备用通道示例
  # - name: "backup-api"
  #   target: "https://backup-api.com"
  #   keys:
  #     - "sk-backup-key"
  #   weight: 5
  #   fallback: true              # 标记为备用
  #   tunnel:
  #     enabled: true
  #     localPort: 8081
  #     remotePort: 9091

# ═══════════════════════════════════════
# 路由规则（可选，默认所有请求走全部通道）
# ═══════════════════════════════════════
# routes:
#   - path: "/v1/**"
#     channels: ["hotaru", "backup-api"]
#     strategy: "priority"        # priority | round-robin | lowest-latency

# ═══════════════════════════════════════
# 全局设置
# ═══════════════════════════════════════
settings:
  reconnectInterval: 5000         # SSH 断线重连间隔（ms）
  logLevel: "info"                # debug | info | warn | error
  hotReload: true                 # 配置文件变化自动重载
  retry:
    maxRetries: 3
    retryOn: [429, 502, 503, 504]
    backoff: "exponential"        # exponential | fixed
    baseDelayMs: 1000
    maxDelayMs: 10000
